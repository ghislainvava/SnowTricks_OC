{% extends 'base.html.twig' %}

{% block body %}
<header>
    {% set firstImg = figure.pictures | first %}
   
      <div >
            <div >
                {% if is_granted('ROLE_ADMIN' )  or (figure.user is same as (app.user))  %}   
                <div class="d-flex justify-content-end">
                    <div  class="position-absolute mt-5 mr-5 bg-light d-flex justify-content-center">
                        <a href="{{ path('edit_figure', {'id' : figure.id}) }}" class="btn btn-sm btn-outline-white"><i class="fa-solid fa-pen-clip"></i></a>             
                        <a href="#" class="btn btn-sm btn-outline-white" data-toggle="modal" data-target="#monModal"><i class="fa-solid fa-trash-can"></i></a>
                    </div>  
                </div>
                <div class="d-flex justify-content-center  w-100 ">
                <h1 class= "position-absolute bg-light  mt-5 text-dark  border border-dark  rounded-pill p-3">{{figure.name}}</h1>
                </div>
                    {# Modal #}
                    <div class="modal text-center" tableindex="-1" role="dialo" id="monModal">
                        <div class="modal-dialog modal-lg"  role="document">
                            <div class="modal-content">
                                <div class="mondal-header">
                                    <button type="button" class="close" data-dismiss="modal">x</button>
                                    <h4 class="modal-tittle">Voulez-vous vraiment supprimer ce snowstrick</h4>
                                </div>
                                <div class="modal-body">
                                    <a href="{{ path('snowtrick_delete', {'id' : figure.id})}}" class="btn btn-sm btn-outline-secondary">Supprimer &nbsp<i class="fa-solid fa-trash-can"></i></a>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-default"  data-dismiss="modal">Fermer</button>
                                </div>
                            </div>
                        </div>
                    </div>                         
                    {% endif %}
            </div>     
            <div >
            {% if firstImg != null %}    
                <img  src="{{ asset('/uploads/' ~ firstImg.name)  }}" alt="Picture" style="max-width: 100%" > 
            {% else %}
                <img  src="{{ asset('/images/snowSnowTrick2.jpg') }}" alt="home_snow" style="max-width: 100%">
            {% endif %}
            </div>
        </div>
</header>
<article class="row mt-5">
    {# <div class="container d-flex owl-carousel owl-theme"> #}
    
    <div class=" owl-carousel owl-theme d-flex row">
    {% for picture in figure.pictures %}
        <div class="item d-flex row">
            <div class="card d-flex row">
             {# {% if figure.pictures | length > 1 %} #}
                
                    <div class="m-3  ">
                        <img src="{{ asset('/uploads/' ~ picture.name )| imagine_filter('carre') }}" alt="Picture" >
                    </div>
               
                {# {% else %}
                    <img class="" src="{{ asset('/images/snowSnowTrick2.jpg') | imagine_filter('carre') }}" alt="home_snow">
                {% endif %} #}
            
            </div>

        
        
        </div>
         {% endfor %}
        <div class="item">
            <div class="card">
             {% for video in figure.videos %}
                  {{ video.frame | raw }}
             {% endfor %}
            </div>
        </div>
   
    </div>
    <div class=" container d-flex justify-content-center m-5">
        <p>{{figure.content | raw}}</p>
    </div>

    <div class=" d-flex container  justify-content-center text-center "> 
    <div class="text-center bg-primary pt-2 px-3 m-3 rounded" > 
        <p>Categories :</p>
        <h4> {{ figure.groupe.name}}</h4>  
    </div>
    <div class="text-center bg-primary pt-2 px-3 m-3 rounded" > 
        <p>Auteur :</p>
        <h4> {{ figure.user.username}}</h4>  
    </div>
    <div class="text-center bg-primary pt-2 px-3 m-3 rounded" > 
        <p>nomn du Trick :</p>
        <h4> {{ figure.name}}</h4>  
    </div>
    <div class="text-center bg-primary pt-2 px-3 m-3 rounded" > 
        <p>Date de création :</p>
        <h5> {{ figure.dateCreate | date('d-m-Y')}}</h5>  
    </div>
    {% if figure.dateEdit != null %}
    <div class="text-center bg-primary pt-2 px-3 m-3 rounded" > 
        <p>Date de modification :</p>
        <h5> {{ figure.dateEdit | date('d-m-Y')}}</h5>  
    </div>
            {% endif %}
    </div>
</article>
<section class="container">
    <div class="d-flex">
         <h2>{{ comments.getTotalItemCount  }} &nbsp<h2>
        {% if comments.getTotalItemCount > 1 %}
        <h2>Commentaires :</h2>
        {% else %}
        <h2>Commentaire :</h2>
        {% endif %} 
    </div>
       
    {% if user %}
            {{form_start(commentForm)}}
         {{ form_row( commentForm.content)}}
         
        <button type="submit" class="btn btn-primary mt-3">laisser un commentaire</button>
        <div class="w-100">
        {{form_end(commentForm)}}
    
    {% endif %}
        {% for comment in comments %}
           <div class="container m-3 d-flex">
                <p class="d-flex align-items-end mr-3"><strong>{{ comment.user.username }}</strong>&nbsp à écrit le : <small>{{comment.createAt | date('d/m/Y à H:i')}}</small></p>
                <h3>{{comment.content}}</h3>
           </div> 
           
        {% endfor %}
   <div class="d-flex align-item-center ">
                     {{ knp_pagination_render(comments) }}
                </div>
  
</section>
 {% endblock %}

